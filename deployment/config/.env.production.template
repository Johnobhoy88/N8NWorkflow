# n8n Workflow Builder v3.0 - Production Environment Template
# This template contains production-specific configurations
# Copy to .env.production and update with actual values

# ==========================================
# PRODUCTION SETTINGS
# ==========================================

NODE_ENV=production
DEPLOYMENT_NAME=workflow-builder-v3-prod
INSTANCE_ID={{INSTANCE_ID}}

# Production URLs
N8N_HOST={{PRODUCTION_HOST}}
N8N_PROTOCOL=https
WEBHOOK_URL=https://{{PRODUCTION_DOMAIN}}/webhook

# ==========================================
# HIGH AVAILABILITY
# ==========================================

# Load Balancing
LOAD_BALANCER_ENABLED=true
LOAD_BALANCER_ALGORITHM=round_robin
STICKY_SESSIONS=true

# Clustering
CLUSTER_ENABLED=true
CLUSTER_WORKERS=4
CLUSTER_RESTART_ON_ERROR=true

# ==========================================
# PRODUCTION DATABASE
# ==========================================

DB_TYPE=postgresdb
DB_POSTGRESDB_HOST={{RDS_ENDPOINT}}
DB_POSTGRESDB_PORT=5432
DB_POSTGRESDB_DATABASE=n8n_workflows_prod
DB_POSTGRESDB_USER={{DB_USER}}
DB_POSTGRESDB_PASSWORD={{DB_PASSWORD}}
DB_POSTGRESDB_SSL_ENABLED=true
DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=true

# Connection Pool (Production)
DB_POSTGRESDB_POOL_MIN=10
DB_POSTGRESDB_POOL_MAX=50
DB_CONNECTION_TIMEOUT=60000

# ==========================================
# PRODUCTION STORAGE
# ==========================================

# AWS S3 Production
S3_BUCKET={{PROD_S3_BUCKET}}
S3_REGION={{AWS_REGION}}
S3_ACCESS_KEY_ID={{AWS_ACCESS_KEY}}
S3_SECRET_ACCESS_KEY={{AWS_SECRET_KEY}}
S3_ENCRYPTION=AES256
S3_VERSIONING=true

# CloudFront CDN
CDN_ENABLED=true
CDN_DOMAIN={{CLOUDFRONT_DOMAIN}}
CDN_CACHE_CONTROL=public, max-age=31536000

# ==========================================
# PRODUCTION SECURITY
# ==========================================

# SSL/TLS
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/{{DOMAIN}}.crt
SSL_KEY_PATH=/etc/ssl/private/{{DOMAIN}}.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt
FORCE_SSL=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000

# WAF Configuration
WAF_ENABLED=true
WAF_RULES=OWASP_TOP_10
WAF_RATE_LIMIT=1000
WAF_BLOCK_COUNTRIES=

# ==========================================
# PRODUCTION MONITORING
# ==========================================

# APM
APM_ENABLED=true
APM_SERVICE_NAME=n8n-workflow-builder
APM_ENVIRONMENT=production
APM_SAMPLE_RATE=0.1

# CloudWatch
CLOUDWATCH_ENABLED=true
CLOUDWATCH_LOG_GROUP=/aws/n8n/workflow-builder
CLOUDWATCH_LOG_STREAM={{INSTANCE_ID}}
CLOUDWATCH_METRICS_NAMESPACE=N8N/WorkflowBuilder

# Alerts
ALERT_EMAIL={{ONCALL_EMAIL}}
ALERT_SLACK_WEBHOOK={{PROD_SLACK_WEBHOOK}}
ALERT_PAGERDUTY_KEY={{PAGERDUTY_PROD_KEY}}

# ==========================================
# PRODUCTION PERFORMANCE
# ==========================================

# Redis Cluster
REDIS_CLUSTER_ENABLED=true
REDIS_CLUSTER_NODES={{REDIS_CLUSTER_ENDPOINTS}}
REDIS_PASSWORD={{REDIS_AUTH_TOKEN}}

# Caching
CACHE_ENABLED=true
CACHE_TTL=7200
CDN_CACHE_ENABLED=true

# Rate Limiting (Production)
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# ==========================================
# PRODUCTION COMPLIANCE
# ==========================================

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_RETENTION_DAYS=2555
AUDIT_LOG_ENCRYPTION=true

# GDPR
GDPR_COMPLIANCE_MODE=strict
PII_MASKING_ENABLED=true
RIGHT_TO_DELETE_ENABLED=true
DATA_PORTABILITY_ENABLED=true

# ==========================================
# DISASTER RECOVERY
# ==========================================

# Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 */6 * * *
BACKUP_RETENTION_DAYS=90
BACKUP_REGION={{BACKUP_REGION}}
BACKUP_CROSS_REGION_REPLICATION=true

# Failover
FAILOVER_ENABLED=true
FAILOVER_REGION={{FAILOVER_REGION}}
FAILOVER_AUTOMATIC=true
FAILOVER_HEALTH_CHECK_INTERVAL=30

# ==========================================
# PRODUCTION LIMITS
# ==========================================

MAX_PAYLOAD_SIZE=50MB
MAX_WORKFLOW_SIZE=25MB
MAX_NODES_PER_WORKFLOW=200
MAX_EXECUTION_TIME_MINUTES=120
MAX_CONCURRENT_EXECUTIONS=100
EXECUTION_TIMEOUT=7200

# ==========================================
# FEATURE FLAGS (PRODUCTION)
# ==========================================

FEATURE_FLAG_ENTERPRISE_QA=true
FEATURE_FLAG_AI_FALLBACK=true
FEATURE_FLAG_AUDIT_LOGGING=true
FEATURE_FLAG_SLACK_NOTIFICATIONS=true
FEATURE_FLAG_ERROR_TRACKING=true
FEATURE_FLAG_PERFORMANCE_MONITORING=true
FEATURE_FLAG_GDPR_COMPLIANCE=true
FEATURE_FLAG_DISASTER_RECOVERY=true