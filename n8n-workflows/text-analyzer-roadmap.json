{
  "project_summary": "User-triggered workflow that accepts text input via webhook form, sends it to Google Gemini API for analysis, and emails the AI-generated response back to the user.",
  "nodes_required": [
    {
      "name": "Webhook_Trigger",
      "type": "webhook",
      "description": "Receives form submission with user text and email address",
      "configuration": {
        "httpMethod": "POST",
        "path": "analyze-text",
        "responseMode": "responseNode",
        "options": {
          "rawBody": false
        }
      },
      "inputs": [],
      "outputs": [
        "HTTP_Request_Gemini"
      ],
      "error_handling": "Return 400 error if required fields missing",
      "expected_payload": {
        "text": "string (required)",
        "email": "string (required)"
      }
    },
    {
      "name": "Validate_Input",
      "type": "code",
      "description": "Validates that text and email fields are present and non-empty",
      "configuration": {
        "language": "javaScript",
        "jsCode": "const text = $input.item.json.text;\nconst email = $input.item.json.email;\n\nif (!text || text.trim() === '') {\n  throw new Error('Text field is required');\n}\n\nif (!email || !email.includes('@')) {\n  throw new Error('Valid email is required');\n}\n\nreturn { text: text.trim(), email: email.trim() };"
      },
      "inputs": [
        "Webhook_Trigger"
      ],
      "outputs": [
        "HTTP_Request_Gemini"
      ],
      "error_handling": "Triggers Error_Response node on validation failure"
    },
    {
      "name": "HTTP_Request_Gemini",
      "type": "httpRequest",
      "description": "Calls Google Gemini API to analyze the submitted text",
      "configuration": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "queryParameters": {
          "key": "AIzaSyDCZtX1HFvgqLkKsloGs6ORB8LaHUuwUOk"
        },
        "sendHeaders": true,
        "headerParameters": {
          "Content-Type": "application/json"
        },
        "sendBody": true,
        "bodyType": "json",
        "body": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \"{{$json.text}}\"\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 0.7,\n    \"maxOutputTokens\": 1024\n  }\n}"
      },
      "inputs": [
        "Validate_Input"
      ],
      "outputs": [
        "Transform_Response"
      ],
      "error_handling": "Retry twice with 1s delay, then trigger Error_Response node"
    },
    {
      "name": "Transform_Response",
      "type": "code",
      "description": "Extracts the analysis text from Gemini API response and combines with email",
      "configuration": {
        "language": "javaScript",
        "jsCode": "const geminiResponse = $input.first().json;\nconst userData = $input.first().json;\n\nconst analysisText = geminiResponse.candidates[0].content.parts[0].text;\n\nreturn {\n  email: userData.email,\n  originalText: userData.text,\n  analysis: analysisText,\n  timestamp: new Date().toISOString()\n};"
      },
      "inputs": [
        "HTTP_Request_Gemini"
      ],
      "outputs": [
        "Send_Email"
      ],
      "error_handling": "If response structure is unexpected, pass raw response to email with error note"
    },
    {
      "name": "Send_Email",
      "type": "emailSend",
      "description": "Sends the Gemini analysis to the user's email address",
      "configuration": {
        "fromEmail": "noreply@farsight.ai",
        "toEmail": "={{$json.email}}",
        "subject": "Your Text Analysis Results",
        "emailType": "text",
        "message": "=Hello,\n\nHere is the analysis of your submitted text:\n\n--- ORIGINAL TEXT ---\n{{$json.originalText}}\n\n--- ANALYSIS ---\n{{$json.analysis}}\n\n---\nGenerated at: {{$json.timestamp}}\n\nThank you for using our service!"
      },
      "inputs": [
        "Transform_Response"
      ],
      "outputs": [],
      "error_handling": "Trigger error handling if email sending fails"
    }
  ],
  "connection_paths": [
    "Webhook_Trigger → Validate_Input",
    "Validate_Input → HTTP_Request_Gemini",
    "HTTP_Request_Gemini → Transform_Response",
    "Transform_Response → Send_Email"
  ],
  "implementation_notes": "Simplified to core happy path (webhook → validate → call Gemini → transform → email). Error handling can be added via continueOnFail flags."
}
